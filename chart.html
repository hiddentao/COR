<html>
<head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
        google.load("visualization", '1', {packages:['corechart']});
        google.setOnLoadCallback(chartLoad);
        $(function() {
            var charts = [
                'Capabilities',
                'Capabilities_1',
                'Capabilities_2',
                'Capabilities_3',
                'Capabilities_4',
                'Capabilities_5',
                'Digital_1',
                'Digital_2',
                'Digital_3',
                'Digital_4',
                'Digital_5',
                'Digital_6',
                'Digital_7',
                'Digital_8',
                'TW3',
                'TW3_1',
                'TW3_2',
                'TW3_3',
                'TW3_4',
                'TW3_5',
                'TW3_6',
                'TW3_7',
                'TW3_8',
                'TW3_9',
                'TW3_10',
                'TW3_11',
                'OPM',
                'OPM_1',
                'MPA',
                'MPA_1',
                'MPA_2',
                'MPA_3',
                'MPA_4',
                'MPA_5',
                'MPA_6',
                'MPA_7',
            ];
            var option = '';
            for (i=0;i<charts.length;i++){
               option += '<option value="'+ charts[i] + '">' + charts[i] + '</option>';
            }
            $('#charts').append(option);
            $('#charts').change(function() {
                drawChart($('#charts').val());
            });

        });
        function chartLoad() {
            drawChart($('#charts').val());
        }
        function drawChart(sheetName) {
          var query = new google.visualization.Query(
              'https://docs.google.com/spreadsheets/d/19nKuPp1xQVWclduV1Jmfh1M67CgvloQh_PFpDMPs3Hk/edit?usp=sharing&range=A2:B100&sheet=' + sheetName);
          query.send(handleQueryResponse);
        }

        function handleQueryResponse(response) {
          if (response.isError()) {
            alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
            return;
          }

          var data = response.getDataTable();
          var formatter = new google.visualization.DateFormat({formatType: 'short'});
          formatter.format(data, 0);
          var chart = new google.visualization.ColumnChart(document.getElementById('chart'));
          var options = {
            legend: { position: 'none' },
          };

          chart.draw(data, options);
        }
    </script>

    <title>Data from a Spreadsheet</title>
</head>

<body>
    <select id="charts">
    </select>
    <span id='chart'></span>

</body>
</html>